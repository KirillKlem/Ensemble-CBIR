# Система поиска смысловых копий изображений на основе глубокого обучения

## Обзор проекта

Данный проект посвящен разработке модели для поиска смысловых копий изображений в заданном множестве фотографий, разделенных на 102 класса. Основная задача — для каждого изображения из тестового набора предоставить 10 релевантных рекомендаций из обучающего множества, где релевантность определяется принадлежностью одному и тому же скрытому классу. Оценка решения производится с помощью метрики MAP@10.

## Подход к решению

Для достижения высокой точности и релевантности рекомендаций был выбран комплексный ансамблевый подход, сочетающий несколько современных методов и моделей глубокого обучения. Такой подход обоснован тем, что разные модели могут улавливать различные аспекты сходства между изображениями, что позволяет более полно характеризовать их смысловое содержание.

### 1. Vision-модели CLIP и ViT-CLIP

Использование моделей CLIP (Contrastive Language–Image Pretraining) и ViT-CLIP позволяет преобразовать изображения в семантическое пространство, где близость эмбеддингов отражает смысловую схожесть изображений. Эти модели обучены на больших объемах данных и способны улавливать высокоуровневые концепции, что делает их идеальными для определения смысловой близости между изображениями из разных классов.

**Почему это важно:** Модели CLIP обеспечивают глубокое понимание контекста и содержания изображений, что повышает точность при поиске смысловых копий.

### 2. Извлечение структурных признаков с помощью ResNet50v2

ResNet50v2 используется для извлечения низкоуровневых и среднеуровневых признаков, связанных со структурой и текстурой изображений. Эта модель способна выявлять детали, которые могут быть упущены трансформерными архитектурами.

**Преимущества:** Комбинируя структурные признаки с семантическими, мы получаем более полное представление об изображении, что улучшает качество рекомендаций.

### 3. Метрическое обучение с использованием GLRTML

Для усиления способности модели различать тонкие различия между изображениями применен метод метрического обучения с функцией потерь GLRTML (Generalized Likelihood Ratio Test Metric Learning). Этот метод позволяет модели адаптивно подстраиваться под данные и улучшать разделимость классов в пространстве эмбеддингов.

**Обоснование:** GLRTML усиливает различия между эмбеддингами разных классов и сближает эмбеддинги внутри одного класса, что повышает релевантность выдаваемых рекомендаций.

### 4. Предварительная обработка изображений с помощью алгоритма Кэнни

Для улучшения качества извлечения признаков была использована предварительная обработка изображений, заключающаяся в выделении контуров с помощью алгоритма Кэнни. Это позволяет сфокусироваться на ключевых объектах на изображении и снизить влияние фона и шума.

**Результат:** Более точное выделение особенностей изображений способствует улучшению качества эмбеддингов и, следовательно, повышает точность поиска.

## Реализация и прозрачность решения

Каждый компонент системы был реализован с акцентом на прозрачность и воспроизводимость:

- **Код структурирован по модулям**, что облегчает понимание и модификацию отдельных частей системы.
- **Использованы общедоступные библиотеки и модели**, такие как PyTorch, TensorFlow, scikit-learn, FAISS и Annoy, что упрощает развёртывание и масштабирование решения.
- **Параметры моделей и методы обучения подробно описаны** в соответствующих скриптах, что позволяет воспроизвести результаты и адаптировать модель под другие задачи.

## Адаптивность и масштабируемость

- **Модульная архитектура** системы позволяет легко заменять или дополнять компоненты, такие как модели эмбеддинга или алгоритмы поиска ближайших соседей.
- **Использование FAISS и Annoy** обеспечивает быстрый поиск по большим наборам данных, что позволяет масштабировать систему на миллионы изображений без значительной потери производительности.
- **Методы обучения** адаптированы для работы с большими объемами данных и могут быть ускорены с помощью GPU.

## Реализация дополнительных идей

В процессе разработки были внедрены дополнительные идеи для улучшения качества поиска:

- **Ансамблирование эмбеддингов**: объединение эмбеддингов из разных моделей (CLIP, ViT, ResNet50v2) для создания более информативного представления изображений.
- **Кластеризация и присвоение псевдо-меток**: использование алгоритмов кластеризации для выявления скрытых структур в данных и улучшения обучения моделей.
- **Тонкая настройка моделей** на предоставленном датасете, что позволяет учесть специфические особенности данных и повысить точность.

## Соответствие поставленной задаче

Предложенное решение полностью соответствует поставленной задаче:

- **Поиск смысловых копий изображений** осуществляется с учетом как семантической, так и визуальной схожести.
- **Генерация рекомендаций** производится в требуемом формате, соответствующем спецификации submission.csv.
- **Метрика MAP@10** была выбрана как основная для оценки качества, и все методы оптимизированы для ее улучшения.

## Заключение

Представленная система является результатом тщательного исследования и интеграции современных методов в области компьютерного зрения и глубокого обучения. Обоснованный выбор моделей и методов, прозрачная реализация и ориентация на масштабируемость делают это решение эффективным и пригодным для практического применения в задачах поиска и рекомендации изображений.

**Примечание:** В реализации были игнорированы оформительские аспекты сайтов и фокус сделан исключительно на содержании изображений, что соответствует требованиям задачи и обеспечивает нейтральность модели к внешним факторам.

